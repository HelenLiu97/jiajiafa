<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/static/css/x-admin.css" media="all">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
</head>
<body>
<div class="x-body">

    <div id="details" style="padding: 20px;" lay-filter="detail">
        <form class="layui-form layui-form-pane" lay-filter="example" id="example" enctype="multipart/form-data">
            <div class="layui-form-item">
                <label class="layui-form-label">旧密码</label>
                <div class="layui-input-block">
                    <input type="text" name="old_pass" required lay-verify="required" placeholder="请输入账号旧密码" autocomplete="off"
                           class="layui-input" id="old_pass">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">密码要求</label>
                <div class="layui-form-mid layui-word-aux"><span style="color:red;font-size: 5px">&nbsp;&nbsp;长度范围8-16位，必须包含数字,字符,符号任意两种或以上！</span></div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">新密码</label>
                <div class="layui-input-block">
                    <input type="password" name="new_pass_one" required lay-verify="required" placeholder="输入新密码" autocomplete="off"
                           class="layui-input" id="new_pass_one">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">确认新密码</label>
                <div class="layui-input-block">
                    <input type="password" name="new_pass_two" required lay-verify="required" placeholder="请确认新密码" autocomplete="off"
                           class="layui-input" id="new_pass_two">
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="formDemo" id="sub" type="submit">立即提交</button>
                </div>
            </div>
        </form>
    </div>


</div>
<script src="/static/layui/layui.all.js" charset="utf-8"></script>
<script>

    var form = layui.form;
    //监听提交
    form.on('submit(formDemo)', function(data){
        var data_info = {data:JSON.stringify(data.field)};
        var $ = layui.jquery;

        $.ajax({
            type : 'POST',
            url : '/change_pass/',
            data : data_info,
            dataType : 'json',
            success : function(data) { localStorage
                // var data1 = JSON.parse(data);
                // 成功提示框
                if (data.code == 0){
                    layer.msg('修改密码成功!', {
                        icon : 6,
                        time: 2500,
                    }, function () {
                        layer.close(layer.index);
                        window.parent.location.reload();
                    });
                }else if(data.code == 502){
                    parent.layer.msg(data.msg, {
                        icon : 5
                    });
                }

            },
            error : function(data) {
                // 异常提示
                layer.msg('出现网络故障', {
                    icon : 5
                });
                layer.closeAll('iframe'); //关闭弹框
            }
        });
        return false;
    });

</script>
</body>
</html>